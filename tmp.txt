Со структурой файла scv все норм, результат возвращаем в результирующий файл.
Условия фильстрации должны идти длуг за другом, как в sql(так и так, и так).